<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Zettlab Research Hub · 用研规范 Demo</title>
  <style>
    :root {
      --bg: #050505;
      --panel: rgba(255, 255, 255, 0.04);
      --panel-hover: rgba(255, 255, 255, 0.08);
      --stroke: rgba(255, 255, 255, 0.08);
      --stroke-strong: rgba(255, 255, 255, 0.15);
      --text: #ffffff;
      --text-muted: rgba(255, 255, 255, 0.6);
      --brand: #7C3AED;
      --brand-glow: rgba(124, 58, 237, 0.3);
      --radius-xl: 32px;
      --radius-lg: 24px;
      --radius-md: 16px;
      --radius-sm: 12px;
      --font: "Inter", "SF Pro Display", -apple-system, BlinkMacSystemFont, sans-serif;
    }

    * { box-sizing: border-box; }
    body {
      margin: 0;
      font-family: var(--font);
      background: var(--bg);
      color: var(--text);
      line-height: 1.5;
      overflow-x: hidden;
      background-image: 
        radial-gradient(circle at 20% 20%, rgba(124, 58, 237, 0.15) 0%, transparent 40%),
        radial-gradient(circle at 80% 80%, rgba(30, 64, 175, 0.15) 0%, transparent 40%);
      background-attachment: fixed;
    }

    .wrap { max-width: 1200px; margin: 0 auto; padding: 0 24px; }

    /* Topbar */
    .topbar {
      position: sticky;
      top: 0;
      z-index: 100;
      background: rgba(5, 5, 5, 0.8);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--stroke);
    }
    .topbar-inner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      height: 72px;
    }
    .brand { display: flex; align-items: center; gap: 12px; text-decoration: none; color: inherit; }
    .brand-logo {
      width: 32px; height: 32px;
      background: linear-gradient(135deg, #7C3AED, #3B82F6);
      border-radius: 10px;
      box-shadow: 0 0 20px var(--brand-glow);
    }
    .brand-text strong { display: block; font-size: 16px; font-weight: 700; }
    .brand-text span { font-size: 12px; color: var(--text-muted); }

    .nav { display: flex; gap: 8px; }
    .nav a {
      padding: 8px 16px;
      border-radius: 99px;
      font-size: 14px;
      color: var(--text-muted);
      text-decoration: none;
      transition: all 0.2s;
    }
    .nav a:hover, .nav a.active { color: var(--text); background: var(--panel); }

    .tools { display: flex; align-items: center; gap: 12px; }
    .search-box {
      position: relative;
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: 99px;
      padding: 6px 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .search-box input {
      background: transparent;
      border: none;
      color: var(--text);
      font-size: 13px;
      outline: none;
      width: 180px;
    }

    .btn {
      padding: 10px 20px;
      border-radius: 99px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      border: 1px solid var(--stroke);
      background: var(--panel);
      color: var(--text);
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }
    .btn:hover { background: var(--panel-hover); transform: translateY(-1px); }
    .btn.primary { background: var(--text); color: var(--bg); border: none; }
    .btn.primary:hover { background: #e5e5e5; }

    /* Hero */
    .hero { padding: 80px 0 60px; text-align: center; }
    .hero h1 { font-size: 56px; font-weight: 800; margin: 0 0 24px; letter-spacing: -0.04em; }
    .hero p { font-size: 18px; color: var(--text-muted); max-width: 800px; margin: 0 auto 40px; line-height: 1.6; }
    .hero-actions { display: flex; justify-content: center; gap: 16px; margin-bottom: 60px; }

    .value-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
    .value-card {
      background: var(--panel);
      border: 1px solid var(--stroke);
      padding: 32px;
      border-radius: var(--radius-lg);
      text-align: left;
      transition: all 0.3s;
    }
    .value-card:hover { border-color: var(--stroke-strong); background: var(--panel-hover); }
    .value-card h3 { margin: 0 0 12px; font-size: 18px; }
    .value-card p { margin: 0; font-size: 14px; color: var(--text-muted); }

    /* Sections */
    .section { padding: 80px 0; }
    .section-header { margin-bottom: 40px; }
    .section-header h2 { font-size: 32px; font-weight: 700; margin: 0 0 12px; }
    .section-header p { color: var(--text-muted); font-size: 16px; }

    /* Filter Bar - Full Width Sticky */
    .filter-container {
      position: sticky;
      top: 72px;
      z-index: 90;
      background: rgba(5, 5, 5, 0.8);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid var(--stroke);
      margin-bottom: 40px;
      width: 100vw;
      left: 50%;
      right: 50%;
      margin-left: -50vw;
      margin-right: -50vw;
    }
    .filter-bar {
      display: flex;
      gap: 8px;
      padding: 16px 0;
      overflow-x: auto;
      max-width: 1200px;
      margin: 0 auto;
      padding-left: 24px;
      padding-right: 24px;
    }
    .filter-item {
      padding: 8px 20px;
      border-radius: 99px;
      font-size: 14px;
      cursor: pointer;
      white-space: nowrap;
      border: 1px solid var(--stroke);
      color: var(--text-muted);
      transition: all 0.2s;
    }
    .filter-item:hover { background: var(--panel); color: var(--text); }
    .filter-item.active { background: var(--text); color: var(--bg); border-color: var(--text); }

    /* Grid */
    .card-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); gap: 24px; }
    .item-card {
      background: var(--panel);
      border: 1px solid var(--stroke);
      border-radius: var(--radius-lg);
      padding: 28px;
      display: flex;
      flex-direction: column;
      gap: 20px;
      transition: all 0.3s;
    }
    .item-card:hover { border-color: var(--stroke-strong); transform: translateY(-4px); }
    .item-card h3 { margin: 0; font-size: 20px; }
    .item-card .tag {
      display: inline-block;
      padding: 4px 12px;
      background: rgba(124, 58, 237, 0.1);
      color: #A78BFA;
      border-radius: 99px;
      font-size: 12px;
      font-weight: 600;
      margin-bottom: 8px;
    }
    .item-card p { margin: 0; font-size: 14px; color: var(--text-muted); line-height: 1.6; }
    .item-card .meta { font-size: 13px; color: var(--text-muted); }
    .item-card .meta strong { color: var(--text); }

    /* SOP Flow */
    .sop-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(260px, 1fr)); gap: 20px; }
    .sop-card {
      background: var(--panel);
      border: 1px solid var(--stroke);
      padding: 24px;
      border-radius: var(--radius-md);
      position: relative;
    }
    .sop-card .step-num {
      font-size: 12px;
      font-weight: 700;
      color: var(--brand);
      margin-bottom: 8px;
      display: block;
    }
    .sop-card h4 { margin: 0 0 8px; font-size: 16px; }
    .sop-card p { margin: 0; font-size: 13px; color: var(--text-muted); }

    /* Governance Flow */
    .gov-flow {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 16px;
      margin-top: 24px;
    }
    .gov-box {
      background: linear-gradient(135deg, rgba(255,255,255,0.05), rgba(255,255,255,0.01));
      border: 1px solid var(--stroke);
      padding: 24px;
      border-radius: var(--radius-md);
      text-align: center;
    }
    .gov-box h4 { margin: 0 0 8px; color: var(--brand); }
    .gov-box p { margin: 0; font-size: 13px; color: var(--text-muted); }

    /* Modal */
    .modal-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0, 0, 0, 0.8);
      backdrop-filter: blur(10px);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 200;
      padding: 20px;
    }
    .modal-overlay.active { display: flex; }
    .modal-content {
      background: #111;
      border: 1px solid var(--stroke-strong);
      width: 100%;
      max-width: 800px;
      max-height: 90vh;
      border-radius: var(--radius-xl);
      overflow: hidden;
      display: flex;
      flex-direction: column;
    }
    .modal-header {
      padding: 24px 32px;
      border-bottom: 1px solid var(--stroke);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    .modal-body { padding: 32px; overflow-y: auto; }
    .modal-close { cursor: pointer; opacity: 0.5; transition: 0.2s; font-size: 24px; }
    .modal-close:hover { opacity: 1; }

    .callout {
      background: rgba(255,255,255,0.03);
      border-radius: var(--radius-md);
      padding: 20px;
      margin-bottom: 16px;
    }
    .callout h4 { margin: 0 0 12px; font-size: 15px; color: var(--text); }
    .callout ul { margin: 0; padding-left: 20px; color: var(--text-muted); font-size: 14px; }
    .callout li { margin-bottom: 8px; }

    .code-block {
      background: #000;
      padding: 20px;
      border-radius: var(--radius-sm);
      font-family: monospace;
      font-size: 13px;
      color: #d1d5db;
      white-space: pre-wrap;
      border: 1px solid var(--stroke);
    }

    /* Toast */
    .toast {
      position: fixed;
      bottom: 32px;
      left: 50%;
      transform: translateX(-50%);
      background: var(--text);
      color: var(--bg);
      padding: 12px 24px;
      border-radius: 99px;
      font-size: 14px;
      font-weight: 600;
      z-index: 300;
      display: none;
    }

    @media (max-width: 768px) {
      .hero h1 { font-size: 40px; }
      .value-grid, .gov-flow { grid-template-columns: 1fr; }
      .nav { display: none; }
    }
  </style>
</head>
<body>

  <header class="topbar">
    <div class="wrap">
      <div class="topbar-inner">
        <a href="#" class="brand">
          <div class="brand-logo"></div>
          <div class="brand-text">
            <strong>Zettlab Research Hub</strong>
            <span>用证据驱动 NAS 体验决策 / Evidence-driven NAS UX</span>
          </div>
        </a>
        <nav class="nav">
          <a href="#sop" class="active">SOP 流程 / Flow</a>
          <a href="#methods">方法库 / Methods</a>
          <a href="#templates">模板 / Templates</a>
          <a href="#repository">归档规范 / Repo</a>
          <a href="#governance">治理 / Gov</a>
        </nav>
        <div class="tools">
          <div class="search-box">
            <input type="text" id="searchInput" placeholder="搜索方法/模板/研究... Search...">
          </div>
          <button class="btn" id="langBtn">CN/EN</button>
        </div>
      </div>
    </div>
  </header>

  <main>
    <section class="hero">
      <div class="wrap">
        <h1>Zettlab Research Hub</h1>
        <p>统一 NAS（桌面端 OS / Web 管理端 / App）的用户研究方法、交付物与质量门槛。研究结论必须可复现、可追溯、可行动。</p>
        <div class="hero-actions">
          <button class="btn primary" onclick="handleCTAClick('start')">发起研究 / Start Study</button>
          <button class="btn" onclick="handleCTAClick('ut')">运行 UT / Run UT</button>
          <button class="btn" onclick="handleCTAClick('repo')">归档规范 / Repository</button>
        </div>
        <div class="value-grid">
          <div class="value-card">
            <h3>可复现 / Repeatable</h3>
            <p>统一脚本、任务与成功标准；同一问题能被不同人重复验证。</p>
          </div>
          <div class="value-card">
            <h3>可行动 / Actionable</h3>
            <p>洞察卡片必须映射到机会点、需求优先级与 Design System 更新项。</p>
          </div>
          <div class="value-card">
            <h3>可验证 / Verifiable</h3>
            <p>上线前后用指标闭环验证，尤其关注 NAS 高风险任务（删除/格式化/权限）。</p>
          </div>
        </div>
      </div>
    </section>

    <section id="status" class="section">
      <div class="wrap">
        <div class="section-header">
          <h2>研究动态 / Research Status</h2>
          <p>最近的研究项目与资产概览。</p>
        </div>
        <div class="card-grid" id="statusGrid"></div>
      </div>
    </section>

    <section id="sop" class="section">
      <div class="wrap">
        <div class="section-header">
          <h2>标准研究流程 / Standard Research Flow (SOP)</h2>
          <p>从目标定义到上线验证的 7 步闭环路径。</p>
        </div>
        <div class="sop-grid" id="sopGrid"></div>
      </div>
    </section>

    <section id="methods" class="section">
      <div class="wrap">
        <div class="section-header">
          <h2>方法工具箱 / Method Toolkit</h2>
          <p>根据研究问题选择最合适的方法。</p>
        </div>
      </div>
      <div class="filter-container">
        <div class="filter-bar" id="methodFilters"></div>
      </div>
      <div class="wrap">
        <div class="card-grid" id="methodGrid"></div>
      </div>
    </section>

    <section id="templates" class="section">
      <div class="wrap">
        <div class="section-header">
          <h2>实战模板 / Templates</h2>
          <p>直接复用的研究计划、脚本与归档模板。</p>
        </div>
      </div>
      <div class="filter-container">
        <div class="filter-bar" id="templateFilters"></div>
      </div>
      <div class="wrap">
        <div class="card-grid" id="templateGrid"></div>
      </div>
    </section>

    <section id="repository" class="section">
      <div class="wrap">
        <div class="section-header">
          <h2>归档与命名规范 / Repository & Naming Rules</h2>
          <p>研究资产必须可追溯：统一命名、统一归档内容、统一链接到结论与行动项。</p>
        </div>
        <div class="value-grid">
          <div class="value-card">
            <h3>命名格式 / Naming Pattern</h3>
            <div class="code-block">[YYYY-MM-DD]_[Surface]_[Topic]_[Method]_[Version]</div>
            <p style="margin-top:12px">示例：2026-01-16_DesktopOS_Onboarding_UT_v1</p>
          </div>
          <div class="value-card" style="grid-column: span 2">
            <h3>必选归档项 / Required Artifacts</h3>
            <div id="requiredArtifactsList" style="display:grid; grid-template-columns: 1fr 1fr; gap: 10px;"></div>
          </div>
        </div>
      </div>
    </section>

    <section id="governance" class="section">
      <div class="wrap">
        <div class="section-header">
          <h2>治理流程 / Governance: Research → Backlog → DS</h2>
          <p>研究不是报告，而是输入系统：洞察进入机会地图；行动项进入 Backlog；模式进入 Design System。</p>
        </div>
        <div class="gov-flow">
          <div class="gov-box"><h4>Evidence</h4><p>访谈/UT/日志/问卷，形成可追溯证据链。</p></div>
          <div class="gov-box"><h4>Insights</h4><p>洞察卡片：证据 → 含义 → 机会 → 建议方案。</p></div>
          <div class="gov-box"><h4>Actions</h4><p>进入 Backlog：按优先级排序；定义验证指标。</p></div>
          <div class="gov-box"><h4>System</h4><p>更新 Design System：组件/模式/文案/状态。</p></div>
        </div>
        <div class="value-grid" style="margin-top: 40px;">
          <div class="value-card">
            <h3>NAS 高风险任务验证 / High-risk Tasks</h3>
            <ul id="riskList"></ul>
          </div>
          <div class="value-card">
            <h3>建议衡量指标 / Suggested Metrics</h3>
            <ul id="metricList"></ul>
          </div>
        </div>
      </div>
    </section>
  </main>

  <div class="modal-overlay" id="modalOverlay">
    <div class="modal-content">
      <div class="modal-header">
        <h3 id="modalTitle">标题</h3>
        <div class="modal-close" onclick="closeModal()">✕</div>
      </div>
      <div class="modal-body" id="modalBody"></div>
    </div>
  </div>

  <div class="toast" id="toast">已复制到剪贴板 / Copied to clipboard</div>

  <script>
    const DATA = {
      studies: [
        {
          id: "s1", date: "2026-01-16", surface: "Desktop OS", topic: "首次配置与存储创建", method: "UT", version: "v1", status: "Done",
          summary: "验证用户在首次进入系统时，能否理解存储池/卷的概念并成功创建。",
          insights: ["用户对 RAID 术语不敏感，更关注数据安全性。","缺少 ETA 说明导致用户在格式化期间产生焦虑。"],
          actions: ["在确认页加入标准化 ETA 说明。","重构 RAID 选择页，增加‘保护 vs 代价’对照表。"]
        },
        {
          id: "s2", date: "2026-01-10", surface: "Web Admin", topic: "成员与权限（共享空间）", method: "Interview", version: "v1", status: "Done",
          summary: "理解管理员对权限的心智模型，以及对“可追溯/审计”的诉求强度。",
          insights: ["管理员希望权限变更可追溯：谁在何时改了什么。","普通用户更关注个人空间边界。"],
          actions: ["Web 端权限模块增加‘变更记录’入口。"]
        },
        {
          id: "s3", date: "2026-01-08", surface: "Mobile App", topic: "手机相册备份授权文案", method: "UT", version: "v1", status: "Done",
          summary: "验证授权文案是否清晰说明‘为何需要/拒绝后影响/隐私边界’。",
          insights: ["‘拒绝将无法使用本模块’过于强硬，缺少替代路径。"],
          actions: ["改为三段式文案：目的→用途→拒绝影响。"]
        }
      ],
      sop: [
        { id: 1, title: "明确目标与范围", en: "Define Goals", desc: "锁定 1–3 个核心问题与假设，定义成功指标。" },
        { id: 2, title: "选择方法与招募", en: "Methods & Recruit", desc: "按问题选方法，按角色分层招募。" },
        { id: 3, title: "执行研究与记录", en: "Run & Capture", desc: "访谈/UT/问卷/日志；记录行为、原话、时间戳。" },
        { id: 4, title: "分析与综合", en: "Synthesize", desc: "亲和图聚类→洞察卡片→心智模型/JTBD。" },
        { id: 5, title: "可视化与沟通", en: "Visualize", desc: "旅程图/机会地图，对齐团队决策与优先级。" },
        { id: 6, title: "转化为行动", en: "Translate", desc: "进入 Backlog；提炼 DS 更新项与验收标准。" },
        { id: 7, title: "上线验证与沉淀", en: "Validate & Archive", desc: "复测 + 指标前后对比；归档到研究库。" }
      ],
      methods: [
        { id: "interview", cat: "qual", title: "半结构化访谈", en: "Interviews", when: "理解动机、担忧、心智模型与决策原因。", out: ["洞察卡片", "心智模型"], notes: "关注数据安全焦虑、术语理解。" },
        { id: "ut", cat: "qual", title: "任务型可用性测试", en: "Usability Testing", when: "验证流程是否能完成、哪里卡住、错误点。", out: ["成功率", "问题清单"], notes: "适用于首次配置、存储创建、备份。" },
        { id: "context", cat: "qual", title: "情境走查", en: "Contextual Inquiry", when: "在真实环境中观察实际行为。", out: ["环境约束", "任务链"], notes: "验证硬件摆放对操作的影响。" },
        { id: "survey", cat: "quant", title: "问卷（规模化）", en: "Surveys", when: "快速验证偏好/满意度。", out: ["趋势分布", "基线指标"], notes: "适合做前后对比。" },
        { id: "cardsort", cat: "ia", title: "卡片分类", en: "Card Sorting", when: "验证导航与命名是否符合直觉。", out: ["IA 建议"], notes: "适合侧边导航、功能命名。" },
        { id: "treetest", cat: "ia", title: "Tree Testing", en: "Tree Testing", when: "验证‘找得到’与路径直觉。", out: ["找到率"], notes: "适合验证设置/权限路径。" }
      ],
      templates: [
        { id: "tpl_plan", cat: "plan", title: "研究计划", en: "Research Plan", desc: "目标/问题/方法/样本/风险/指标。", content: "# 研究计划模板\n- 背景与目标：\n- 核心问题：\n- 假设：\n- 样本分层：\n- 成功指标：" },
        { id: "tpl_ut", cat: "ut", title: "UT 脚本", en: "UT Script", desc: "首次进入→创建存储→文件管理→备份。", content: "# UT 脚本模板\nT1 首页感知\nT2 存储创建任务\nT3 备份设置\n记录：S/P/F、时长、错误" },
        { id: "tpl_screener", cat: "screener", title: "招募筛选", en: "Screener", desc: "NAS 经验、数据类型、平台、共享需求。", content: "# 招募筛选模板\n1. 是否用过 NAS？\n2. 主要存储什么数据？\n3. 使用什么终端设备？" },
        { id: "tpl_insight", cat: "insight", title: "洞察卡", en: "Insight Card", desc: "证据 → 含义 → 机会 → 建议方案。", content: "# 洞察卡片模板\n- 现象：\n- 证据（截图/原话）：\n- 含义：\n- 建议方案：" },
        { id: "tpl_repo", cat: "repo", title: "归档清单", en: "Archive Checklist", desc: "确保研究可追溯的完整包清单。", content: "# 归档清单\n- [ ] 研究计划\n- [ ] 测试脚本\n- [ ] 原始录屏/笔记\n- [ ] 洞察卡片\n- [ ] 行动项跟踪" }
      ],
      artifacts: [
        { key: "plan", zh: "研究计划", en: "Research Plan" },
        { key: "script", zh: "脚本与任务列表", en: "Script & Tasks" },
        { key: "raw", zh: "原始记录链接", en: "Raw Evidence" },
        { key: "insights", zh: "洞察卡片", en: "Insight Cards" },
        { key: "actions", zh: "行动项清单", en: "Action Items" },
        { key: "ds", zh: "DS 更新建议", en: "DS Updates" }
      ],
      risks: ["删除/格式化（不可逆）", "存储池/RAID 改动", "权限与共享设置", "远程访问开关"],
      metrics: ["任务完成率 (S/P/F)", "任务耗时 (Time-on-task)", "信任度评分 (1-7)", "误操作率"]
    };

    let state = { lang: 'zh', methodCat: 'all', tplCat: 'all' };

    function renderStatus() {
      const grid = document.getElementById('statusGrid');
      grid.innerHTML = DATA.studies.map(s => `
        <div class="item-card">
          <div>
            <div class="tag">${s.surface}</div>
            <h3>${s.topic}</h3>
            <p class="meta"><strong>${s.date}</strong> · ${s.method} · ${s.status}</p>
          </div>
          <p>${s.summary}</p>
          <button class="btn" onclick="openStudyModal('${s.id}')">查看详情 / View Details</button>
        </div>
      `).join('');
    }

    function renderSOP() {
      const grid = document.getElementById('sopGrid');
      grid.innerHTML = DATA.sop.map(s => `
        <div class="sop-card">
          <span class="step-num">STEP ${s.id}</span>
          <h4>${s.title} / ${s.en}</h4>
          <p>${s.desc}</p>
        </div>
      `).join('');
    }

    function renderMethods() {
      const grid = document.getElementById('methodGrid');
      const filtered = DATA.methods.filter(m => state.methodCat === 'all' || m.cat === state.methodCat);
      grid.innerHTML = filtered.map(m => `
        <div class="item-card">
          <div>
            <div class="tag">${m.en}</div>
            <h3>${m.title}</h3>
          </div>
          <p>${m.when}</p>
          <div class="meta"><strong>产出:</strong> ${m.out.join(', ')}</div>
          <button class="btn" onclick="openMethodModal('${m.id}')">查看详情 / View Details</button>
        </div>
      `).join('');
    }

    function renderTemplates() {
      const grid = document.getElementById('templateGrid');
      const filtered = DATA.templates.filter(t => state.tplCat === 'all' || t.cat === state.tplCat);
      grid.innerHTML = filtered.map(t => `
        <div class="item-card">
          <div>
            <div class="tag">${t.en}</div>
            <h3>${t.title}</h3>
          </div>
          <p>${t.desc}</p>
          <div style="display:flex; gap:8px;">
            <button class="btn" onclick="openTemplateModal('${t.id}')">预览 / Preview</button>
            <button class="btn" onclick="copyTemplate('${t.id}')">复制 / Copy</button>
          </div>
        </div>
      `).join('');
    }

    function renderFilters() {
      const mFilters = document.getElementById('methodFilters');
      const cats = [
        {id:'all', zh:'全部', en:'All'},
        {id:'qual', zh:'定性', en:'Qual'},
        {id:'quant', zh:'定量', en:'Quant'},
        {id:'ia', zh:'信息架构', en:'IA'}
      ];
      mFilters.innerHTML = cats.map(c => `
        <div class="filter-item ${state.methodCat === c.id ? 'active' : ''}" onclick="state.methodCat='${c.id}';renderFilters();renderMethods();">
          ${c.zh} / ${c.en}
        </div>
      `).join('');

      const tFilters = document.getElementById('templateFilters');
      const tCats = [
        {id:'all', zh:'全部', en:'All'},
        {id:'plan', zh:'研究计划', en:'Plan'},
        {id:'ut', zh:'UT 脚本', en:'UT'},
        {id:'screener', zh:'招募筛选', en:'Screener'},
        {id:'insight', zh:'洞察卡', en:'Insight'},
        {id:'repo', zh:'归档', en:'Repo'}
      ];
      tFilters.innerHTML = tCats.map(c => `
        <div class="filter-item ${state.tplCat === c.id ? 'active' : ''}" onclick="state.tplCat='${c.id}';renderFilters();renderTemplates();">
          ${c.zh} / ${c.en}
        </div>
      `).join('');
    }

    function renderArtifacts() {
      const list = document.getElementById('requiredArtifactsList');
      list.innerHTML = DATA.artifacts.map(a => `
        <div style="font-size:14px; color:var(--text-muted)">• ${a.zh} / ${a.en}</div>
      `).join('');
    }

    function renderGov() {
      document.getElementById('riskList').innerHTML = DATA.risks.map(r => `<li>${r}</li>`).join('');
      document.getElementById('metricList').innerHTML = DATA.metrics.map(m => `<li>${m}</li>`).join('');
    }

    // Modals
    function openModal(title, body) {
      document.getElementById('modalTitle').innerText = title;
      document.getElementById('modalBody').innerHTML = body;
      document.getElementById('modalOverlay').classList.add('active');
    }
    function closeModal() { document.getElementById('modalOverlay').classList.remove('active'); }

    function openStudyModal(id) {
      const s = DATA.studies.find(x => x.id === id);
      const body = `
        <div class="callout"><h4>摘要 / Summary</h4><p>${s.summary}</p></div>
        <div class="callout"><h4>洞察 / Insights</h4><ul>${s.insights.map(i => `<li>${i}</li>`).join('')}</ul></div>
        <div class="callout"><h4>行动项 / Actions</h4><ul>${s.actions.map(a => `<li>${a}</li>`).join('')}</ul></div>
      `;
      openModal(s.topic, body);
    }

    function openMethodModal(id) {
      const m = DATA.methods.find(x => x.id === id);
      const body = `
        <div class="callout"><h4>适用场景 / Use When</h4><p>${m.when}</p></div>
        <div class="callout"><h4>产出物 / Outputs</h4><ul>${m.out.map(o => `<li>${o}</li>`).join('')}</ul></div>
        <div class="callout"><h4>备注 / Notes</h4><p>${m.notes}</p></div>
      `;
      openModal(m.title, body);
    }

    function openTemplateModal(id) {
      const t = DATA.templates.find(x => x.id === id);
      const body = `<div class="code-block">${t.content}</div>`;
      openModal(t.title, body);
    }

    function copyTemplate(id) {
      const t = DATA.templates.find(x => x.id === id);
      navigator.clipboard.writeText(t.content).then(() => {
        const toast = document.getElementById('toast');
        toast.style.display = 'block';
        setTimeout(() => toast.style.display = 'none', 2000);
      });
    }

    function handleCTAClick(type) {
      if(type === 'start') openTemplateModal('tpl_plan');
      else if(type === 'ut') openTemplateModal('tpl_ut');
      else if(type === 'repo') openTemplateModal('tpl_repo');
    }

    // Search
    document.getElementById('searchInput').addEventListener('input', (e) => {
      const q = e.target.value.toLowerCase();
      // Simple search logic for demo
      const cards = document.querySelectorAll('.item-card');
      cards.forEach(c => {
        const text = c.innerText.toLowerCase();
        c.style.display = text.includes(q) ? 'flex' : 'none';
      });
    });

    // Init
    renderStatus();
    renderSOP();
    renderFilters();
    renderMethods();
    renderTemplates();
    renderArtifacts();
    renderGov();
  </script>
</body>
</html>
